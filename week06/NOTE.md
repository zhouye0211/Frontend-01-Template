# 每周总结可以写在这里
##### 第六周

### 有限状态机:概念
- 是一个非常有用的模型，可以模拟世界上大部分事物。它有三个特征
 1. 状态总数（state）是有限的。
 2. 任一时刻，只处在一种状态之中。
 3. 某种条件下，会从一种状态转变（transition）到另一种状态。

> 先来解释什么是“状态”（ State ）。现实事物是有不同状态的，例如一个自动门，就有 open 和 closed 两种状态。我们通常所说的状态机是有限状态机，也就是被描述的事物的状态的数量是有限个，例如自动门的状态就是两个 open 和 closed 。

### 有限状态机:四大概念
1. 第一个是 State ，状态。一个状态机至少要包含两个状态。例如上面自动门的例子，有 open 和 closed 两个状态。
2. 第二个是 Event ，事件。事件就是执行某个操作的触发条件或者口令。对于自动门，“按下开门按钮”就是一个事件。
3. 第三个是 Action ，动作。事件发生以后要执行动作。例如事件是“按开门按钮”，动作是“开门”。编程的时候，一个 Action 一般就对应一个函数。
4. 第四个是 Transition ，变换。也就是从一个状态变化为另一个状态。例如“开门过程”就是一个变换。

### 浏览器渲染流程
- 构建DOM树
> 因为浏览器无法直接理解和使用 HTML，所以需要将 HTML 转换为浏览器能够理解的结构——DOM 树


- 样式计算
1. 把 CSS 转换为浏览器能够理解的结构
2. 转换样式表中的属性值，使其标准化
3. 计算出 DOM 树中每个节点的具体样式


- 布局阶段
1. 创建布局树
2. 布局计算


- 分层阶段
> 因为页面中有很多复杂的效果，如一些复杂的 3D 变换、页面滚动，或者使用 z-indexing 做 z 轴排序等，为了更加方便地实现这些效果，渲染引擎还需要为特定的节点生成专用的图层，并生成一棵对应的图层树（LayerTree）。
1. 拥有层叠上下文属性的元素会被提升为单独的一层
2. 需要剪裁（clip）的地方也会被创建为图层


- 图层绘制
> 在完成图层树的构建之后，渲染引擎会对图层树中的每个图层进行绘制 。渲染引擎实现图层的绘制与之类似，会把一个图层的绘制拆分成很多小的绘制指令，然后再把这些指令按照顺序组成一个待绘制列表

- 栅格化（raster）操作
> 合成线程会按照视口附近的图块来优先生成位图，实际生成位图的操作是由栅格化来执行的。所谓栅格化，是指将图块转换为位图。


- 合成和显示
> 一旦所有图块都被光栅化，合成线程就会生成一个绘制图块的命令——“DrawQuad”，然后将该命令提交给浏览器进程。浏览器进程里面有一个叫 viz 的组件，用来接收合成线程发过来的 DrawQuad 命令，然后根据 DrawQuad 命令，将其页面内容绘制到内存中，最后再将内存显示在屏幕上。